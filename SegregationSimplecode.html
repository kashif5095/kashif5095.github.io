<pre><font color="#007f69">globals</font><font color="#000000"> [<br />  percent-similar  </font><font color="#5a5a5a">;; on the average, what percent of a turtle's neighbors</font><font color="#000000"><br />                   </font><font color="#5a5a5a">;; are the same color as that turtle?</font><font color="#000000"><br />  percent-unhappy  </font><font color="#5a5a5a">;; what percent of the turtles are unhappy?</font><font color="#000000"><br />]<br /><br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [<br />  happy?          </font><font color="#5a5a5a">;; for each turtle, indicates whether at least %-similar-wanted percent of</font><font color="#000000"><br />                  </font><font color="#5a5a5a">;; that turtle's neighbors are the same color as the turtle</font><font color="#000000"><br />  similar-nearby  </font><font color="#5a5a5a">;; how many neighboring patches have a turtle with my color?</font><font color="#000000"><br />  total-nearby    </font><font color="#5a5a5a">;; how many neighboring patches have a turtle?</font><font color="#000000"><br />]<br /><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; create a turtle on NUMBER randomly selected patches.</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; note that slider's maximum value is 2500 which is a little less than the total number of patches</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">n-of</font><font color="#000000"> number </font><font color="#660096">patches</font><font color="#000000"> [<br />    </font><font color="#0000aa">sprout</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">;; make approximately half the turtles red and the other half green</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> [ </font><font color="#963700">red</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> ]<br />  ]<br />  update-turtles<br />  update-globals<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">all?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [ happy? ] [ </font><font color="#0000aa">stop</font><font color="#000000"> ]<br />  move-unhappy-turtles<br />  update-turtles<br />  update-globals<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> move-unhappy-turtles<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [ </font><font color="#660096">not</font><font color="#000000"> happy? ]<br />    [ find-new-spot ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> find-new-spot<br />  </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"><br />  </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#660096">random-float</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">other</font><font color="#000000"> </font><font color="#660096">turtles-here</font><font color="#000000"><br />    [ find-new-spot ]          </font><font color="#5a5a5a">;; keep going until we find an unoccupied patch</font><font color="#000000"><br />  </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">pxcor</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000">  </font><font color="#5a5a5a">;; move to center of patch</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-turtles<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [<br />    </font><font color="#5a5a5a">;; in next two lines, we use &quot;neighbors&quot; to test the eight patches</font><font color="#000000"><br />    </font><font color="#5a5a5a">;; surrounding the current patch</font><font color="#000000"><br /><br />    </font><font color="#5a5a5a">;; count the number of my neighbors that are the same color as me</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> similar-nearby </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">neighbors</font><font color="#000000">)<br />      </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">myself</font><font color="#000000">]<br /><br />    </font><font color="#5a5a5a">;; count the total number of neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> total-nearby </font><font color="#660096">count</font><font color="#000000"> (</font><font color="#660096">turtles-on</font><font color="#000000"> </font><font color="#660096">neighbors</font><font color="#000000">)<br /><br />    </font><font color="#5a5a5a">;; Iâ€™m happy if there are at least the minimal number of same-colored neighbors</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> happy? similar-nearby </font><font color="#660096">&gt;=</font><font color="#000000"> ( %-similar-wanted </font><font color="#660096">*</font><font color="#000000"> total-nearby </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> )<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> update-globals<br />  </font><font color="#0000aa">let</font><font color="#000000"> similar-neighbors </font><font color="#660096">sum</font><font color="#000000"> [similar-nearby] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> total-neighbors </font><font color="#660096">sum</font><font color="#000000"> [total-nearby] </font><font color="#660096">of</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> percent-similar (similar-neighbors </font><font color="#660096">/</font><font color="#000000"> total-neighbors) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> percent-unhappy (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">not</font><font color="#000000"> happy?]) </font><font color="#660096">/</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">) </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; Copyright 2006 Uri Wilensky.</font><font color="#000000"><br /></font><font color="#5a5a5a">; See Info tab for full copyright and license.</font>
</pre>
